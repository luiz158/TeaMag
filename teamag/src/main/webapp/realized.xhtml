<?xml version='1.0' encoding='ISO-8859-1' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	template="WEB-INF/layouts/template.xhtml">

	<ui:define name="title">Gestion du budget</ui:define>


	<ui:define name="content">

	<p:panel header="Nouvelle tâche">
		<h:form>
			<table>
				<tr>
					<td><h:outputLabel value="Projet/Appli :" for="acProject" />
						<p:autoComplete id="acProject"
							value="#{workController.newTask.project}"
							completeMethod="#{workController.completeProject}" /></td>
					<td><h:outputLabel value="Nom* :" for="acName" /> <p:autoComplete
							id="acName" value="#{workController.newTask.name}"
							completeMethod="#{workController.completeName}" /></td>
					<td><p:commandButton value="Ajouter"
							action="#{workController.doCreateActivity}" ajax="false"
							icon="ui-icon-plusthick" /></td>
				</tr>
			</table>

		</h:form>
	</p:panel>
	<br />
	<h:form id="idForm" action="#{workController.update}">
		<p:panel
			header="Réalisé de #{workController.realizedBean.currentMonthStr}"
			id="idPanel">
			<p:commandButton value="Semaine précédente" ajax="false"
				action="#{workController.previousWeek}"
				disabled="#{workController.realizedBean.isFirstWeek}"
				icon="ui-icon-arrowthick-1-w" />
			<p:commandButton value="Semaine suivante"
				action="#{workController.nextWeek}" ajax="false"
				disabled="#{workController.realizedBean.isLastWeek}"
				icon="ui-icon-arrowthick-1-e" />


			<p:contextMenu for="idTable">
				<p:menuitem value="Supprimer la tâche" update="idTable"
					icon="ui-icon-trash" action="#{workController.deleteTask}" />
			</p:contextMenu>


			<p:dataTable id="idTable" var="taskWeek"
				value="#{workController.realizedBean.taskWeeks}"
				sortBy="#{taskWeek.task.project}-#{taskWeek.task.name}"
				sortOrder="ascending"
				selection="#{workController.realizedBean.selectedTaskWeek}"
				selectionMode="single" rowKey="#{taskWeek.task.id}">

				<f:facet name="header">  
           Semaine #{workController.realizedBean.weekNumber}
        	</f:facet>

				<p:column headerText="Tâche"
					sortBy="#{taskWeek.task.project}-#{taskWeek.task.name}"
					footerText="Total">
					<h:outputText
						value="#{taskWeek.task.project}-#{taskWeek.task.name}" size="35" />
				</p:column>

				<p:columns value="#{workController.realizedBean.columnsDay}"
					var="column" style="align:center;">
					<f:facet name="header" size="2">  
                #{column.dayHeader}  
            		</f:facet>
					<p:inputText value="#{taskWeek[column.dayNumber].totalEditStr}"
						size="2" />

					<f:facet name="footer" size="2">  
	                #{column.total}  
            		</f:facet>

				</p:columns>


			</p:dataTable>
			<br />
			<p:commandButton value="Enregistrer"
				action="#{workController.update}" ajax="false" icon="ui-icon-disk" />
			<br />
			<br />
			<b>Pour supprimer une tâche, clic droit sur la ligne. Attention
				ceci supprime la tâche et tout réalisé éventuel pour tout le mois !</b>


		</p:panel>
		<br />


		<!-- 		<p:panel header="Export Excel">
					<h:commandLink>
				<p:graphicImage value="/images/excel.gif" />
				<p:dataExporter type="xls" target="idTable" fileName="realise.xls" />
			</h:commandLink>
				</p:panel> -->
	</h:form>

</ui:define>
</ui:composition>